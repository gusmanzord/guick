#set( $js  = "$")
#set( $open  = "${")
#set( $close = "}")
#set( $entityBeanName = ${util.uncapitalize($entity.name)} )
#set( $projectBeanName = ${util.uncapitalize($project.name)} )
'use strict';

/**
 * @ngdoc service
 * @name ${projectBeanName}App.${projectBeanName}Service
 * @description
 * # myService
 * Factory in the ${projectBeanName}App.
 */

var ${projectBeanName}Services = angular.module('${projectBeanName}Services');

${projectBeanName}Services.factory('dashboardService', ['$resource',
    function ($resource) {
        var basicOptions = {
            chart: {
                type: 'discreteBarChart',
                title: {
                    enable: true,
                    text: "Graficos ${project.name}"
                },
                height: 450,
                margin : {
                    top: 20,
                    right: 20,
                    bottom: 60,
                    left: 55
                },
                x: function(d){return d.LABEL;},
                y: function(d){return parseInt(d.VALUE);},
                showValues: true,
                transitionDuration: 500,
                xAxis: {
                    rotateLabels: -25
                },
                yAxis: {
                    axisLabelDistance: 25
                }
            }
        };

        var service = $resource('/${projectBeanName}/api/reports/dashboard/', {}, {
#set( $mainEntities = ${project.getAllMainEntities()} )
#foreach( ${entity} in ${mainEntities} )
#foreach( ${e} in ${entity.getOneToManyProperties()} )
#set($capitalizedName = $util.capitalize( ${e.name} ) )
#set($numericProperties = ${e.referedEntity.getAllNumericProperties()} )
#if( !${e.referedEntity.looksLikeEnum()} && ${numericProperties.size()} > 0 && !${entity.getId().isEmbeddable()} && !${e.referedEntity.id.isEmbeddable()})
#set($capitalizedProp = $util.capitalize( ${numericProperties[0].name} ) )
            'get${capitalizedName}WithSum${e.referedEntity.name}${capitalizedProp}': { method: 'GET', url: '/${projectBeanName}/api/reports/dashboard/get${entity}WithSum${e.referedEntity.name}${capitalizedProp}', isArray: true},
#end
#if( !${e.referedEntity.looksLikeEnum()} && ${numericProperties.size()} > 1 && !${entity.getId().isEmbeddable()} && !${e.referedEntity.id.isEmbeddable()})
#set($capitalizedProp = $util.uncapitalize( ${numericProperties[1].name} ) )
            'get${capitalizedName}WithSum${e.referedEntity.name}${capitalizedProp}': { method: 'GET', url: '/${projectBeanName}/api/reports/dashboard/get${entity}WithSum${e.referedEntity.name}${capitalizedProp}', isArray: true},
#end
#if( !${e.referedEntity.looksLikeEnum()} && ${numericProperties.size()} > 2 && !${entity.getId().isEmbeddable()} && !${e.referedEntity.id.isEmbeddable()})
#set($capitalizedProp = $util.uncapitalize( ${numericProperties[2].name} ) )
            'get${capitalizedName}WithSum${e.referedEntity.name}${capitalizedProp}': { method: 'GET', url: '/${projectBeanName}/api/reports/dashboard/get${entity}WithSum${e.referedEntity.name}${capitalizedProp}', isArray: true},
#end
#end
#end
            'allCount': { method: 'GET', url: '/${projectBeanName}/api/reports/dashboard/allCount', isArray: true}

        });

        service.getBasicOptions = function (){
            return basicOptions;
        };

        return service;
    }
]);
